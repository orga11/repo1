/*! konyviz 2015-08-29 */
var __getDSObjIdForAnnotation__=function(a){return a.proj_guid+"_annotations_"+a.channel},__readAnnotationFromDataStore__=function(a){var b=__getDSObjIdForAnnotation__(a);if(kony.store.getItem(b)&&Object.keys(kony.store.getItem(b)).length>0){var c=kony.store.getItem(b);if(c[a.annotation_id])return c[a.annotation_id]}return null},__writeAnnotationToDataStore__=function(a,b){var c=__getDSObjIdForAnnotation__(a);if(kony.store.getItem(c)&&Object.keys(kony.store.getItem(c)).length>0){var d=kony.store.getItem(c);null!=b&&(d[a.annotation_id]=b),kony.store.setItem(c,d)}else{var d={};null!=b&&(d[a.annotation_id]=b),kony.store.setItem(c,d)}},__addOrAppendAnnotationTODS__=function(a,b,c){function d(b){var c=annotationsUtil.createComment(e,g),d=c.commentId;return b.comments[e.widgetId]||(b.comments[e.widgetId]={}),b.comments[e.widgetId][d]=c,__writeAnnotationToDataStore__(a,b),b}var e=b,f=kony.ds.read("kvsession")[0],g=f.userDetails,h=a.annotation_id;e.widgetId=h,e.formId=h;try{var i=null;if(null!==__readAnnotationFromDataStore__(a)){var j=__readAnnotationFromDataStore__(a);e.channel=a.channel,i=d(j)}else e.channel=a.channel,i=d({widgetId:h,active:1,comments:{}});c({status:400,error:null,data:i})}catch(k){c({status:200,err:k,data:null})}},__deleteCommentFROMDS__=function(a,b,c){b.active=0,__updateCommentTODS__(a,b,c)},__updateCommentTODS__=function(a,b,c){var d=kony.ds.read("kvsession")[0],e=d.userDetails;try{if(null!==__readAnnotationFromDataStore__(a)){var f=__readAnnotationFromDataStore__(a);f=annotationsUtil.updateComment(b,e,f),__writeAnnotationToDataStore__(a,f),c({status:400,error:null,data:f})}}catch(g){c({status:200,err:g,data:null})}},__openAnnotation__=function(a,b){if(null!==__readAnnotationFromDataStore__(a)){var c=__readAnnotationFromDataStore__(a);b({status:400,data:c})}else b({status:200,data:null})},fpas={addOrAppendAnnotationTODS:__addOrAppendAnnotationTODS__,updateCommentTODS:__updateCommentTODS__,deleteCommentFROMDS:__deleteCommentFROMDS__,openAnnotation:__openAnnotation__,readAnnotationFromDataStore:__readAnnotationFromDataStore__,writeAnnotationToDataStore:__writeAnnotationToDataStore__};